<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agartha Penguin Adventure</title>
    <style>
        body { margin: 0; font-family: Arial, sans-serif; }
        #game-container {
            position: relative;
            width: 800px;
            height: 600px;
            margin: 20px auto;
            background-image: url('https://www.comicschau.de/wp-content/uploads/2025/12/agartha-meme-trend-tiktok-bedeutung.jpg');
            background-size: cover;
            background-position: center;
            border: 2px solid #000;
            overflow: hidden;
        }
        .penguin {
            position: absolute;
            width: 50px;
            height: 50px;
            background-image: url('https://e7.pngegg.com/pngimages/18/190/png-clipart-club-penguin-island-wikia-club-penguin-elite-penguin-force-purple-club-penguin.png');
            background-size: contain;
            background-repeat: no-repeat;
            transition: top 0.1s, left 0.1s;
        }
        .name-tag {
            position: absolute;
            top: -20px;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 12px;
            color: #fff;
            text-shadow: 1px 1px 2px #000;
        }
        #chat-container {
            position: absolute;
            bottom: 10px;
            left: 10px;
            width: 300px;
            height: 200px;
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid #000;
            padding: 10px;
            overflow-y: scroll;
        }
        #chat-input {
            position: absolute;
            bottom: 220px;
            left: 10px;
            width: 300px;
        }
    </style>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>
<body>
    <div id="game-container">
        <div id="chat-container"></div>
        <input type="text" id="chat-input" placeholder="Type to chat...">
    </div>

    <script>
        // Replace with your Firebase config
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.firebaseio.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const playerId = Math.random().toString(36).substr(2, 9); // Unique player ID
        const playerName = prompt('Enter your penguin name:') || 'Anonymous';
        const playersRef = db.ref('players');
        const chatRef = db.ref('chat');

        // Local player data
        let player = {
            x: 400,
            y: 300,
            name: playerName
        };

        // Create local penguin element
        const penguinElem = document.createElement('div');
        penguinElem.className = 'penguin';
        penguinElem.id = playerId;
        const nameTag = document.createElement('div');
        nameTag.className = 'name-tag';
        nameTag.textContent = playerName;
        penguinElem.appendChild(nameTag);
        document.getElementById('game-container').appendChild(penguinElem);

        // Update position function
        function updatePosition() {
            penguinElem.style.left = `${player.x}px`;
            penguinElem.style.top = `${player.y}px`;
            playersRef.child(playerId).set(player);
        }

        // Key controls for movement
        document.addEventListener('keydown', (e) => {
            const speed = 10;
            switch (e.key) {
                case 'ArrowUp': player.y = Math.max(0, player.y - speed); break;
                case 'ArrowDown': player.y = Math.min(550, player.y + speed); break;
                case 'ArrowLeft': player.x = Math.max(0, player.x - speed); break;
                case 'ArrowRight': player.x = Math.min(750, player.x + speed); break;
            }
            updatePosition();
        });

        // Sync other players
        playersRef.on('value', (snapshot) => {
            const players = snapshot.val();
            for (let id in players) {
                if (id === playerId) continue;
                let otherElem = document.getElementById(id);
                if (!otherElem) {
                    otherElem = document.createElement('div');
                    otherElem.className = 'penguin';
                    otherElem.id = id;
                    const otherNameTag = document.createElement('div');
                    otherNameTag.className = 'name-tag';
                    otherElem.appendChild(otherNameTag);
                    document.getElementById('game-container').appendChild(otherElem);
                }
                otherElem.style.left = `${players[id].x}px`;
                otherElem.style.top = `${players[id].y}px`;
                otherElem.querySelector('.name-tag').textContent = players[id].name;
            }
        });

        // Remove disconnected players
        playersRef.on('child_removed', (snapshot) => {
            const removedElem = document.getElementById(snapshot.key);
            if (removedElem) removedElem.remove();
        });

        // Chat functionality
        const chatContainer = document.getElementById('chat-container');
        const chatInput = document.getElementById('chat-input');
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && chatInput.value.trim()) {
                chatRef.push({ name: playerName, message: chatInput.value });
                chatInput.value = '';
            }
        });

        chatRef.on('child_added', (snapshot) => {
            const msg = snapshot.val();
            const msgElem = document.createElement('div');
            msgElem.textContent = `${msg.name}: ${msg.message}`;
            chatContainer.appendChild(msgElem);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        });

        // Clean up on disconnect
        playersRef.child(playerId).onDisconnect().remove();

        // Initial update
        updatePosition();
    </script>
</body>
</html>
